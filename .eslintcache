[{"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\index.js":"1","D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\config.js":"2","D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\utility\\reportWebVitals.js":"3","D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\Pages\\Home.tsx":"4","D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\Pages\\LoggedIn.js":"5","D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\AltaAuth\\index.tsx":"6"},{"size":743,"mtime":1608376049877,"results":"7","hashOfConfig":"8"},{"size":250,"mtime":1608858769337,"results":"9","hashOfConfig":"8"},{"size":362,"mtime":1607431892071,"results":"10","hashOfConfig":"8"},{"size":1501,"mtime":1608603336859,"results":"11","hashOfConfig":"8"},{"size":148,"mtime":1608037371452,"results":"12","hashOfConfig":"8"},{"size":5814,"mtime":1608816081298,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1g4of8y",{"filePath":"16","messages":"17","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"20","messages":"21","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"24","messages":"25","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"26"},"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\index.js",[],"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\config.js",["27"],"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\utility\\reportWebVitals.js",[],"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\Pages\\Home.tsx",["28","29","30"],"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\Pages\\LoggedIn.js",[],"D:\\Users\\Alta\\Downloads\\IS Examples\\js-oauth\\src\\AltaAuth\\index.tsx",["31","32","33","34","35","36"],"import React from 'react';\r\n\r\nimport { User } from 'oidc-client';\r\n\r\nimport { AuthContextProps, AuthProviderProps, RequireAuthProps } from './interfaces';\r\n\r\nconst AuthContext = React.createContext<AuthContextProps | null>(null);\r\n\r\nfunction loadScript(callback:()=>void)\r\n{\r\n    var style = document.createElement(\"link\");\r\n    style.rel = \"stylesheet\";\r\n    style.href = \"https://accounts.townshiptale.com/includes/altastyle.css\";\r\n    document.head.appendChild(style);\r\n\r\n    var element = document.createElement(\"script\");\r\n    element.setAttribute(\"src\", \"https://accounts.townshiptale.com/includes/altaapi.js\");\r\n    document.head.appendChild(element);\r\n    element.onload = callback;\r\n}\r\n\r\ndeclare global {\r\n    interface Window {\r\n        altaApi:any;\r\n    }\r\n}\r\n\r\nexport const AuthConsumer = AuthContext.Consumer;\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({\r\n    config, \r\n    children, \r\n    configureManager, \r\n    location=window.location, \r\n    autoSignIn=false}) =>\r\n{\r\n    const [loaded, setLoaded] = React.useState(false);\r\n    const [userData, setUserData] = React.useState<User | null>(null);\r\n\r\n    React.useEffect(() =>\r\n    {   \r\n        loadScript(() =>\r\n        {\r\n            window.altaApi.init(config, () =>\r\n            {\r\n                configureManager && configureManager(window.altaApi.oidc);\r\n                \r\n                window.altaApi.oidc.events.addUserLoaded((user:any) => { console.log(\"User loaded\"); console.log(user); setUserData(user); });\r\n                window.altaApi.oidc.events.addUserUnloaded(() => { console.log(\"User unloaded\"); setUserData(null); });\r\n            \r\n                window.altaApi.checkSignInCallback(location);\r\n\r\n                setLoaded(true);\r\n            });\r\n        });\r\n    },\r\n    []);\r\n\r\n    React.useEffect(() =>\r\n    {\r\n        if (!!window.altaApi)\r\n        {\r\n            if (window.altaApi.checkSignInCallback(location))\r\n            {\r\n                return;\r\n            }\r\n\r\n            const getUser = async () =>\r\n            { \r\n                var user = await window.altaApi.getUser();\r\n\r\n                if (!!user && !user.expired && !userData)\r\n                {\r\n                    setUserData(user);\r\n                }\r\n                else if ((!user || user.expired) && autoSignIn)\r\n                {\r\n                    console.log(\"SIGNIN\");\r\n                    console.log(user);\r\n\r\n                    window.altaApi.signIn()\r\n                    .then((result:any) => console.log(result))\r\n                    .catch((error:any) => console.error(error));\r\n                }\r\n            }\r\n\r\n            getUser();\r\n        }\r\n    },\r\n    [location, !!window.altaApi]);\r\n\r\n    return <AuthContext.Provider\r\n        value={!!window.altaApi ? {...window.altaApi, userData } : undefined}>\r\n        {children}\r\n    </AuthContext.Provider>\r\n}\r\n\r\n\r\nexport const useAuth = () => {\r\n    return React.useContext<AuthContextProps|null>(AuthContext);\r\n  };\r\n\r\n/**\r\n * A public higher-order component to access the imperative API\r\n */\r\nexport function withAuth<P extends AuthContextProps>(\r\n    Component: React.ComponentType<P>,\r\n  ): React.ComponentType<Omit<P, keyof AuthContextProps>> {\r\n    const displayName = `withAuth(${Component.displayName || Component.name})`;\r\n    const C: React.FC<Omit<P, keyof AuthContextProps>> = (props) => {\r\n      const auth = useAuth();\r\n  \r\n      return <Component {...(props as P)} {...auth} />;\r\n    };\r\n  \r\n    C.displayName = displayName;\r\n  \r\n    return C;\r\n  }\r\n  \r\n  \r\nexport const RequireAuth : React.FC<RequireAuthProps> = ({LoggingInComponent, children}) =>\r\n{\r\n    const auth = useAuth();\r\n\r\n    React.useEffect(() =>\r\n    {\r\n        if (!!auth?.oidc && !auth.userData)\r\n        {\r\n            auth?.signIn()\r\n            .then(result => console.log(result))\r\n            .catch(error => console.error(error));\r\n        }\r\n    },\r\n    [!!auth?.oidc, auth?.userData]);\r\n\r\n    if (!auth?.userData)\r\n    {\r\n        if (!!LoggingInComponent)\r\n        {\r\n            const Component = LoggingInComponent as any;\r\n\r\n            return <Component retry={() => auth?.signIn()}/>;\r\n        }\r\n        else\r\n        {\r\n            return <div>\r\n                <h1>Showing login in popup.</h1>\r\n                <button onClick={() => \r\n                    auth?.signIn()\r\n                    .then(result => console.log(result))\r\n                    .catch(error => console.error(error))}>Click here if it doesn't appear.</button>\r\n            </div>\r\n        }\r\n    }\r\n\r\n    return <>\r\n            {children}\r\n        </>;\r\n}\r\n\r\n\r\nexport function LoginButton({small = false, style, type='auto'} : {small?:Boolean, style?: React.CSSProperties, type?:'auto'|'login'|'logout'})\r\n{\r\n    var auth = useAuth();\r\n\r\n    var isLogin = type === 'auto' ? !auth?.userData : (type === 'login');\r\n\r\n    var username = auth?.userData?.profile?.Username; \r\n\r\n    var onClick = () =>\r\n    {\r\n        if (!auth?.oidc)\r\n        {\r\n            console.error(\"Can't login until alta login library is loaded.\");\r\n            return;\r\n        }\r\n\r\n        var login = isLogin ? auth.signIn : auth.signOut;\r\n\r\n        login().then(console.log).catch(console.error);\r\n    }\r\n    \r\n    var className = isLogin ? 'alta_loginWithAlta' : 'alta_loginWithAlta alta_loggedIn';\r\n\r\n    return <div className={className} style={style}>\r\n        <button onClick={onClick}>\r\n            <img alt='icon1' src='https://accounts.townshiptale.com/icon.svg'/>\r\n            <img alt='icon2' src='https://accounts.townshiptale.com/icon.svg'/>\r\n            <span className=\"alta_noHover\">{isLogin ? (small ? \"Login\" : \"Login with Alta\") : username}</span>\r\n            <span className=\"alta_hover\">{isLogin ? (small ? \"Login\" : \"Login with Alta\") : \"Logout\"}</span>\r\n        </button>\r\n    </div>\r\n}",{"ruleId":"37","severity":1,"message":"38","line":1,"column":1,"nodeType":"39","endLine":6,"endColumn":2},{"ruleId":"40","severity":1,"message":"41","line":30,"column":10,"nodeType":"42","messageId":"43","endLine":30,"endColumn":15},{"ruleId":"44","severity":1,"message":"45","line":40,"column":5,"nodeType":"46","endLine":40,"endColumn":34,"suggestions":"47"},{"ruleId":"48","severity":1,"message":"49","line":54,"column":71,"nodeType":"50","messageId":"51","endLine":54,"endColumn":73},{"ruleId":"40","severity":1,"message":"52","line":37,"column":12,"nodeType":"42","messageId":"43","endLine":37,"endColumn":18},{"ruleId":"44","severity":1,"message":"53","line":57,"column":5,"nodeType":"46","endLine":57,"endColumn":7,"suggestions":"54"},{"ruleId":"44","severity":1,"message":"55","line":90,"column":5,"nodeType":"46","endLine":90,"endColumn":33,"suggestions":"56"},{"ruleId":"44","severity":1,"message":"57","line":90,"column":16,"nodeType":"58","endLine":90,"endColumn":32},{"ruleId":"44","severity":1,"message":"45","line":135,"column":5,"nodeType":"46","endLine":135,"endColumn":35,"suggestions":"59"},{"ruleId":"44","severity":1,"message":"57","line":135,"column":6,"nodeType":"58","endLine":135,"endColumn":18},"import/no-anonymous-default-export","Assign object to a variable before exporting as module default","ExportDefaultDeclaration","@typescript-eslint/no-unused-vars","'error' is assigned a value but never used.","Identifier","unusedVar","react-hooks/exhaustive-deps","React Hook React.useEffect has a missing dependency: 'auth'. Either include it or remove the dependency array.","ArrayExpression",["60"],"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'loaded' is assigned a value but never used.","React Hook React.useEffect has missing dependencies: 'config', 'configureManager', and 'location'. Either include them or remove the dependency array. If 'configureManager' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["61"],"React Hook React.useEffect has missing dependencies: 'autoSignIn' and 'userData'. Either include them or remove the dependency array.",["62"],"React Hook React.useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","UnaryExpression",["63"],{"desc":"64","fix":"65"},{"desc":"66","fix":"67"},{"desc":"68","fix":"69"},{"desc":"70","fix":"71"},"Update the dependencies array to be: [auth, auth.userData.profile.sub]",{"range":"72","text":"73"},"Update the dependencies array to be: [config, configureManager, location]",{"range":"74","text":"75"},"Update the dependencies array to be: [autoSignIn, location, userData]",{"range":"76","text":"77"},"Update the dependencies array to be: [auth, auth.userData]",{"range":"78","text":"79"},[1114,1143],"[auth, auth.userData.profile.sub]",[1783,1785],"[config, configureManager, location]",[2671,2699],"[autoSignIn, location, userData]",[3904,3934],"[auth, auth.userData]"]